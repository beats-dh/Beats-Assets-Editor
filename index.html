<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/src/styles/main.css" />
    <link rel="stylesheet" href="/src/features/layout/headerSpacing.css" />
    <link rel="stylesheet" href="/src/features/assetGrid/assetSelectionLayout.css" />
    <link rel="stylesheet" href="/src/styles/map-viewer.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tibia Assets Editor</title>
    <script type="module" src="/src/main.ts" defer></script>
  </head>

  <body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
      <div class="loading-container">
        <div class="loading-logo">
          <div class="tibia-logo">‚öîÔ∏è</div>
          <h1 data-i18n="app.title">Tibia Assets Editor</h1>
          <p class="loading-subtitle" data-i18n="loading.subtitle">Professional Asset Management Tool</p>
        </div>
        
        <div class="loading-progress">
          <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
          </div>
          <p id="loading-text" class="loading-text" data-i18n="loading.text.initial">Initializing...</p>
        </div>

        <div class="setup-section" id="setup-section">
          <div class="setup-card">
            <h2 data-i18n="setup.heading">üéØ Setup Your Tibia Client</h2>
            <div class="input-group">
              <label for="tibia-path" data-i18n="setup.tibiaPathLabel">Tibia Client Path:</label>
              <div class="input-row">
                <input
                  type="text"
                  id="tibia-path"
                  placeholder="C:\Path\To\Tibia"
                  class="modern-input"
                  data-i18n-placeholder="setup.tibiaPathPlaceholder"
                />
                <button id="browse-dir" class="btn-secondary" data-i18n="setup.browseButton">Selecionar diret√≥rio</button>
              </div>
            </div>
            <button id="load-button" class="btn-primary">
              <span class="btn-icon">üöÄ</span>
              <span data-i18n="setup.loadButton">Load Assets</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Application -->
    <div id="main-app" class="main-app" style="display: none;">
      <!-- Navigation Header -->
      <header class="app-header">
        <div class="header-content">
          <div class="logo-section">
            <div class="app-logo">‚öîÔ∏è</div>
            <div class="app-title">
              <h1 data-i18n="app.title">Tibia Assets Editor</h1>
              <p class="app-subtitle" data-i18n="app.subtitle">Professional Asset Management</p>
            </div>
          </div>
          
          <div class="header-stats" id="header-stats">
            <!-- Stats will be loaded here -->
          </div>

          <div class="header-actions">
            <button id="settings-btn" class="icon-btn" title="Configura√ß√µes" data-i18n-title="header.settings.tooltip">‚öôÔ∏è</button>
            <div id="settings-menu" class="settings-menu">
              <div class="settings-section">
                <div class="settings-section-header">
                  <h4 class="settings-title" data-i18n="settings.language.title">Linguagem</h4>
                  <p class="settings-description" data-i18n="settings.language.description">Selecione o idioma da interface.</p>
                </div>
                <select id="language-select" class="settings-select">
                  <option value="default" data-i18n="language.option.default">Default (multil√≠ngue)</option>
                  <option value="pt-BR" data-i18n="language.option.pt">Portugu√™s</option>
                  <option value="en" data-i18n="language.option.en">English</option>
                  <option value="es" data-i18n="language.option.es">Espa√±ol</option>
                  <option value="ru" data-i18n="language.option.ru">–†—É—Å—Å–∫–∏–π</option>
                </select>
              </div>

              <div class="menu-divider"></div>

              <div class="settings-section">
                <div class="settings-section-header">
                  <h4 class="settings-title" data-i18n="settings.theme.title">Cores</h4>
                  <p class="settings-description" data-i18n="settings.theme.description">Escolha um tema que combine com voc√™.</p>
                </div>
                <div class="theme-grid" role="list">
                  <button class="theme-option" type="button" data-theme="default" role="listitem">
                    <span class="theme-name" data-i18n="theme.default">Padr√£o</span>
                    <span class="theme-preview">
                      <span class="color-swatch" style="background: #4f46e5;"></span>
                      <span class="color-swatch" style="background: #7c3aed;"></span>
                      <span class="color-swatch" style="background: #10b981;"></span>
                    </span>
                  </button>
                  <button class="theme-option" type="button" data-theme="ocean" role="listitem">
                    <span class="theme-name" data-i18n="theme.ocean">Oceanic</span>
                    <span class="theme-preview">
                      <span class="color-swatch" style="background: #0ea5e9;"></span>
                      <span class="color-swatch" style="background: #22d3ee;"></span>
                      <span class="color-swatch" style="background: #1abc9c;"></span>
                    </span>
                  </button>
                  <button class="theme-option" type="button" data-theme="aurora" role="listitem">
                    <span class="theme-name" data-i18n="theme.aurora">Aurora</span>
                    <span class="theme-preview">
                      <span class="color-swatch" style="background: #8b5cf6;"></span>
                      <span class="color-swatch" style="background: #ec4899;"></span>
                      <span class="color-swatch" style="background: #2c2555;"></span>
                    </span>
                  </button>
                  <button class="theme-option" type="button" data-theme="ember" role="listitem">
                    <span class="theme-name" data-i18n="theme.ember">Ember</span>
                    <span class="theme-preview">
                      <span class="color-swatch" style="background: #f97316;"></span>
                      <span class="color-swatch" style="background: #f43f5e;"></span>
                      <span class="color-swatch" style="background: #3a2218;"></span>
                    </span>
                  </button>
                  <button class="theme-option" type="button" data-theme="forest" role="listitem">
                    <span class="theme-name" data-i18n="theme.forest">Floresta</span>
                    <span class="theme-preview">
                      <span class="color-swatch" style="background: #22c55e;"></span>
                      <span class="color-swatch" style="background: #14b8a6;"></span>
                      <span class="color-swatch" style="background: #1d3f27;"></span>
                    </span>
                  </button>
                  <button class="theme-option" type="button" data-theme="dusk" role="listitem">
                    <span class="theme-name" data-i18n="theme.dusk">Crep√∫sculo</span>
                    <span class="theme-preview">
                      <span class="color-swatch" style="background: #f59e0b;"></span>
                      <span class="color-swatch" style="background: #38bdf8;"></span>
                      <span class="color-swatch" style="background: #2b3045;"></span>
                    </span>
                  </button>
                </div>
              </div>

              <div class="menu-divider"></div>

              <div class="settings-section">
                <h4 class="settings-title" data-i18n="settings.preferences.title">Prefer√™ncias</h4>
                <div class="settings-item">
                  <label>
                    <input type="checkbox" id="auto-animate-toggle" />
                    <span data-i18n="settings.preferences.autoAnimate">Anima√ß√£o autom√°tica na grade</span>
                  </label>
                </div>
                <button id="clear-cache-btn" class="menu-btn" data-i18n="settings.preferences.clearCache">Limpar cache de sprites</button>
              </div>
            </div>
            <button id="home-btn" class="icon-btn" title="Tela inicial" data-i18n-title="header.home.tooltip">üè†</button>
            <button id="refresh-btn" class="icon-btn" title="Refresh" data-i18n-title="header.refresh.tooltip">üîÑ</button>
          </div>
        </div>
      </header>

      <!-- Category Navigation -->
      <nav class="category-nav">
        <div class="nav-container">
          <!-- Main Categories -->
          <div class="category-cards">
            <div class="category-card" data-category="Objects">
              <div class="card-icon">üì¶</div>
              <div class="card-content">
                <h3 data-i18n="category.objects">Objects</h3>
                <p id="objects-count">0 items</p>
              </div>
              <div class="card-arrow">‚Üí</div>
            </div>

            <div class="category-card" data-category="Outfits">
              <div class="card-icon">üëï</div>
              <div class="card-content">
                <h3 data-i18n="category.outfits">Outfits</h3>
                <p id="outfits-count">0 items</p>
              </div>
              <div class="card-arrow">‚Üí</div>
            </div>

            <div class="category-card" data-category="Effects">
              <div class="card-icon">‚ú®</div>
              <div class="card-content">
                <h3 data-i18n="category.effects">Effects</h3>
                <p id="effects-count">0 items</p>
              </div>
              <div class="card-arrow">‚Üí</div>
            </div>

            <div class="category-card" data-category="Missiles">
              <div class="card-icon">üèπ</div>
              <div class="card-content">
                <h3 data-i18n="category.missiles">Missiles</h3>
                <p id="missiles-count">0 items</p>
              </div>
              <div class="card-arrow">‚Üí</div>
            </div>

            <div class="category-card" data-category="Sounds">
              <div class="card-icon">üîä</div>
              <div class="card-content">
                <h3 data-i18n="category.sounds">Sounds</h3>
                <p id="sounds-count">0 items</p>
              </div>
              <div class="card-arrow">‚Üí</div>
            </div>

            <div class="category-card" data-category="Maps">
              <div class="card-icon">üó∫Ô∏è</div>
              <div class="card-content">
                <h3 data-i18n="category.maps">Maps</h3>
                <p>OTBM Viewer</p>
              </div>
              <div class="card-arrow">‚Üí</div>
            </div>
          </div>

          <!-- Subcategories Section -->
          <div class="subcategories-section">
            <h3 class="subcategories-title" data-i18n="subcategories.title">Object Subcategories</h3>
            <div class="subcategories-grid">
              <div class="subcategory-card" data-category="Objects" data-subcategory="Armors">
                <span class="subcat-icon">üõ°Ô∏è</span>
                <span class="subcat-name" data-i18n="subcategory.armors">Armors</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Amulets">
                <span class="subcat-icon">üìø</span>
                <span class="subcat-name" data-i18n="subcategory.amulets">Amulets</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Boots">
                <span class="subcat-icon">üë¢</span>
                <span class="subcat-name" data-i18n="subcategory.boots">Boots</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Containers">
                <span class="subcat-icon">üéí</span>
                <span class="subcat-name" data-i18n="subcategory.containers">Containers</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Decoration">
                <span class="subcat-icon">üé®</span>
                <span class="subcat-name" data-i18n="subcategory.decoration">Decoration</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Food">
                <span class="subcat-icon">üçñ</span>
                <span class="subcat-name" data-i18n="subcategory.food">Food</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="HelmetsHats">
                <span class="subcat-icon">‚õëÔ∏è</span>
                <span class="subcat-name" data-i18n="subcategory.helmetsHats">Helmets & Hats</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Legs">
                <span class="subcat-icon">üëñ</span>
                <span class="subcat-name" data-i18n="subcategory.legs">Legs</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Potions">
                <span class="subcat-icon">üß™</span>
                <span class="subcat-name" data-i18n="subcategory.potions">Potions</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Rings">
                <span class="subcat-icon">üíç</span>
                <span class="subcat-name" data-i18n="subcategory.rings">Rings</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Runes">
                <span class="subcat-icon">üîÆ</span>
                <span class="subcat-name" data-i18n="subcategory.runes">Runes</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Shields">
                <span class="subcat-icon">üõ°Ô∏è</span>
                <span class="subcat-name" data-i18n="subcategory.shields">Shields</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Tools">
                <span class="subcat-icon">üîß</span>
                <span class="subcat-name" data-i18n="subcategory.tools">Tools</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Valuables">
                <span class="subcat-icon">üíé</span>
                <span class="subcat-name" data-i18n="subcategory.valuables">Valuables</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Axes">
                <span class="subcat-icon">ü™ì</span>
                <span class="subcat-name" data-i18n="subcategory.axes">Axes</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Clubs">
                <span class="subcat-icon">üèè</span>
                <span class="subcat-name" data-i18n="subcategory.clubs">Clubs</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="DistanceWeapons">
                <span class="subcat-icon">üèπ</span>
                <span class="subcat-name" data-i18n="subcategory.distance">Distance</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="Swords">
                <span class="subcat-icon">‚öîÔ∏è</span>
                <span class="subcat-name" data-i18n="subcategory.swords">Swords</span>
              </div>
              <div class="subcategory-card" data-category="Objects" data-subcategory="WandsRods">
                <span class="subcat-icon">ü™Ñ</span>
                <span class="subcat-name" data-i18n="subcategory.wandsRods">Wands & Rods</span>
              </div>
            </div>
          </div>
        </div>
      </nav>

      <!-- Category View -->
      <main id="category-view" class="category-view" style="display: none;">
        <!-- Modern Unified Header -->
        <header class="modern-header">
          <div class="header-left">
            <button id="back-btn" class="modern-back-btn">
              <svg class="back-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
              </svg>
              <span data-i18n="categoryView.back">Back</span>
            </button>

            <div class="header-divider"></div>
            <!-- Removido: bloco de categoria (√≠cone, t√≠tulo e subt√≠tulo) -->
          </div>

          <div id="appearance-action-bar" class="appearance-action-bar" aria-label="Appearance actions"></div>

          <div class="header-center">
            <div class="search-container">
              <div class="search-input-wrapper">
                <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <circle cx="11" cy="11" r="8"/>
                  <path d="M21 21l-4.35-4.35"/>
                </svg>
                <input
                  type="text"
                  id="asset-search"
                  placeholder="Search assets..."
                  class="search-input"
                  data-i18n-placeholder="search.placeholder"
                />
                <button id="clear-search" class="clear-search-btn" style="display: none;">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <div class="header-right">
            <div class="results-info">
              <span id="results-count" class="results-text">0 itens</span>
            </div>

            <div class="pagination-nav" role="group" aria-label="Controle de pagina√ß√£o" data-i18n-aria-label="pagination.aria">
              <button id="prev-page" class="pagination-btn" type="button" aria-label="P√°gina anterior" data-i18n-aria-label="pagination.previous">
                <span>‚óÄ</span>
              </button>
              <div class="pagination-info">
                <span id="page-info" class="results-text">P√°gina 1 de 1</span>
              </div>
              <button id="next-page" class="pagination-btn" type="button" aria-label="Pr√≥xima p√°gina" data-i18n-aria-label="pagination.next">
                <span>‚ñ∂</span>
              </button>
            </div>

            <div class="page-size-container" aria-label="Itens por p√°gina" data-i18n-aria-label="pageSize.aria">
              <select id="page-size" class="page-size-select">
                <option value="100" selected>100</option>
                <option value="500">500</option>
                <option value="1000">1000</option>
                <option value="10000">10000</option>
                <option value="50000">50000</option>
              </select>
            </div>

            <div id="subcategory-container" class="filter-container" style="display: none;">
              <select id="subcategory-select" class="filter-select">
                <option value="All" data-i18n="subcategory.option.all">All</option>
              </select>
            </div>

          </div>
        </header>

        <div class="view-content">
          <div id="assets-grid" class="modern-assets-grid">
            <!-- Assets will be loaded here -->
          </div>
        </div>
      </main>

      <!-- Map Viewer Section -->
      <section id="map-section" class="map-section" style="display: none;">
        <!-- Map viewer will be initialized here by mapViewer.ts -->
      </section>

      <!-- Asset Details Modal -->
      <div id="asset-details" class="asset-details-modal">
        <div class="modal-backdrop" onclick="closeAssetDetails()"></div>
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-tabs">
              <button id="tab-details" class="tab-btn active" data-tab="details" data-i18n="modal.detailsTab">Asset Details</button>
              <button id="tab-edit" class="tab-btn" data-tab="edit" data-i18n="modal.editTab">Edit</button>
              <button id="tab-texture" class="tab-btn" data-tab="texture" data-i18n="modal.textureTab">Texture</button>
            </div>
            <div class="modal-actions">
              <div class="modal-nav-controls" role="group" aria-label="Navigate assets" data-i18n-aria-label="modal.nav.aria">
                <button
                  id="prev-asset"
                  class="detail-nav-btn"
                  type="button"
                  aria-label="Previous asset"
                  title="Previous asset"
                  data-i18n-aria-label="modal.prevTooltip"
                  data-i18n-title="modal.prevTooltip"
                >
                  <span aria-hidden="true">‚óÄ</span>
                </button>
                <button
                  id="next-asset"
                  class="detail-nav-btn"
                  type="button"
                  aria-label="Next asset"
                  title="Next asset"
                  data-i18n-aria-label="modal.nextTooltip"
                  data-i18n-title="modal.nextTooltip"
                >
                  <span aria-hidden="true">‚ñ∂</span>
                </button>
              </div>
              <button id="close-details" class="close-btn" type="button">‚úï</button>
            </div>
          </div>
          <div class="modal-body">
            <div id="details-content" class="tab-content">
              <!-- Asset details will be loaded here -->
            </div>
            <div id="edit-content" class="tab-content" style="display: none;"></div>
            <div id="texture-content" class="tab-content" style="display: none;"></div>
          </div>
        </div>
      </div>

      <!-- Confirm Dialog Modal -->
      <div id="confirm-modal" class="asset-details-modal" role="dialog" aria-modal="true" aria-labelledby="confirm-title" aria-describedby="confirm-message" style="display: none;">
        <div class="modal-backdrop"></div>
        <div class="modal-content" role="document">
          <div class="modal-header">
            <h2 id="confirm-title">Confirmar a√ß√£o</h2>
            <button id="close-confirm" class="close-btn" aria-label="Fechar confirma√ß√£o">‚úï</button>
          </div>
          <div class="modal-body">
            <p id="confirm-message">Tem certeza que deseja prosseguir?</p>
            <div class="edit-actions">
              <button id="confirm-ok" class="btn-delete" aria-label="Confirmar">Confirmar</button>
              <button id="confirm-cancel" class="btn-save" aria-label="Cancelar">Cancelar</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Sound Modal -->
      <div id="add-sound-modal" class="asset-details-modal" role="dialog" aria-modal="true" aria-labelledby="add-sound-title" aria-describedby="add-sound-desc" style="display: none;">
        <div class="modal-backdrop"></div>
        <div class="modal-content" role="document">
          <div class="modal-header">
            <h2 id="add-sound-title">Adicionar Som</h2>
            <button id="close-add-sound" class="close-btn" aria-label="Fechar modal de adi√ß√£o">‚úï</button>
          </div>
          <div class="modal-body">
            <div id="add-sound-content" class="tab-content" aria-live="polite">
              <!-- Add sound form will be rendered here -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Status Messages -->
    <div id="status-message" class="status-toast" style="display: none;"></div>
  </body>
</html>
